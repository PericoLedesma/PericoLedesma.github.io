<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
	<title>Simulation</title>
	 <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
</head>
<body style="background-image: url('images/image.jpg');">
	<h1 id="ex" style="color: black;
font-family: arial, sans-serif;
font-size: 20px;
font-weight: bold;
margin-top: 0px;
margin-bottom: 1px;">Riddle Simulation</h1>

	<!-- partial:index.partial.html -->
	<header class="header" role="banner">
			<div>
			<img src="images/image2.png" width="90" height="121" class="center2">
		</div>

	  <h1 class="logo">
		<a href="#">The hundred Prisoners and a Light Bulb Riddle.</a>
	  </h1>
	  <div>

		<nav class="main-nav" role="navigation">
		  <ul class="unstyled list-hover-slide">
			<li><a href="index.html">Introduction</a></li>
			<li><a href="riddle.html">Riddle</a></li>
			<li><a href="protocols.html">Protocols</a></li>
			<li><a href="simulation.html">Simulation</a></li>
			<li><a href="conclusion.html">Conclusion</a></li>
			<li><a href="LAMAS_Project_proposal-5.pdf">The paper</a></li>
			<li><a href="https://github.com/PericoLedesma/PericoLedesma.github.io">Github</a></li>
		  </ul>
		</nav>
	  </div>
	</header>

	<div class="medio">
		<p>
			For the simulation of the riddle we want to create a interactive dashboard in which many setting can be chosen, and changed. The settings we want to create are: number of prisoners, number of light bulbs, solving protocol, time and sequence. In which the number of prisoners, light bulbs and solving protocol are obvious settings the sequence and time need some extra explanation. We want to let the user type in there own sequence or a random sequence which is generated by a sequence generator. After which the solver can check if the sequence is solvable for the chosen other settings. Then if the sequence is not solvable we also want to create a setting that the sequence can be added with the names needed to solve the sequence. We also want to create a setting for the sequence that the shortest answer is generated. The time setting can be adjusted in which the time is the time between interrogations. Then if the sequence is solved or not the time the prisoners are locked up is also displayed.
        </p>

			<p>
			<h3 style="color: black;
font-family: arial, sans-serif;
font-size: 16px;
font-weight: bold;
margin-top: 0px;
margin-bottom: 1px;">Downloading simulation </h3>
		<br>At the time of writing, the latest version of Python is Python 3.7. However, due to a problem in Pygame, this version of Python does not work with the simulation. For running the simulation Python 3.6 is required. To run the simulation, follow these steps:

		<ul>
			<li>Set up a virtual environment.
				<br>

				python3 -m venv venv or python3.6 -m venv venv

			</li>


		</ul>

		python3 -m venv venv or python3.6 -m venv venv
		Activate the virtual environment>
		source venv/bin/activate
		Install the required Python packages, Pygame and Numpy
		pip install pygame numpy or pip install -r requirements.txt
		Start the simulation
		python game.py
		<br>
		-----
		</p>
				  <py-env>
			  - numpy
			  - random
			  </py-env>
				<py-script>
					print('--')
					print('Start of the simulation in PYTHON')
					print('--')

					prisoner_count = 4
					list_length = 15
					lightbulbs = 2

					def generate_sequence():
						prisoner_order = []
						for i in range (0, list_length):
							n = random.randint(1, prisoner_count)
							prisoner_order.append(n)
						# print(prisoner_order)
						return prisoner_order

					def set_counter(prisoners_list):
						# this should take some user input,
						# but for now I always set the first prisoner as counter
						i = 0
						prisoners_list[i] = 2
						return prisoners_list

					# sets first n as counters, then sets the groups of all remaining prisoners, dividing as evenly as possible
					def set_counter_and_groups(prisoners_list, num_lightbulbs):
						# this should take some user input,
						# but for now I always set the first n prisoners as counter
						num_prisoners = len(prisoners_list)
						remainder = num_prisoners % num_lightbulbs
						group_size = (num_prisoners - remainder) / num_lightbulbs
						group_sizes = [group_size] * num_lightbulbs
						for i in range(0, remainder):
							group_sizes[i] += 1
						counters = list(range(0, num_lightbulbs))
						new_prisoners_list = numpy.zeros(shape=(3, num_prisoners))
						total = 0
						for i in range (0, len(group_sizes)):
							# set counters number of times turned on lightbulb to -1 to identify them
							x = int(total)
							new_prisoners_list[2][x] = -1
							for n in range(int(total), (int(total) + int(group_sizes[i]))):
								new_prisoners_list[0][n] = i + 1
							total += group_sizes[i]
						# print(new_prisoners_list)
						return group_sizes, new_prisoners_list


					def protocol_1(prisoners_sequence, prisoners_list):
						count = 0
						# 0 is off and 1 is on
						lightbulb = 0
						steps = 0
						#iterate over prisoner list
						for i in prisoners_sequence:
							steps += 1
							# not counter, lightbulb off
							if prisoners_list[i-1] == 0 and lightbulb == 0:
								prisoners_list[i-1] = 1
								lightbulb = 1
							#counter, lightbulb on
							elif prisoners_list[i-1] == 2 and lightbulb == 1:
								count += 1
								lightbulb = 0
							if count == prisoner_count - 1:
								break

						if count == prisoner_count - 1:
							print("Protocol 1 works and the prisoners escape. The counter can declare all prisoners have been counted "
								  "on day " + str(steps))
						else:
							print("Protocol 1 does not work as the counter never declares all prisoners have been in the room")
						return None


					def main():
						# step 1 generate sequence
						prisoners_sequence = generate_sequence()
						# create list of prisoners and set counter (could be controlled by user input)
						prisoners_list = [0] * prisoner_count
						prisoners_list = set_counter(prisoners_list)
						# run protocol 1
						protocol_1(prisoners_sequence, prisoners_list)

					if __name__ == "__main__":
    					main()

				</py-script>
	</div>
</body>
</html>